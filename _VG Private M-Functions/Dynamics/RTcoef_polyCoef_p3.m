%% *RTcoef_polyCoef_p3*
% Coefficients of the polynom for p3 calculation

%%
% *Author:* Geser Dugarov 2018

%%
function coefPoly_p3 = RTcoef_polyCoef_p3(elastParam, a, p1)

    Vp0  = elastParam(1);
    Vs0  = elastParam(2);
    eps  = elastParam(3);
    gam  = elastParam(4);
    delt = elastParam(5);
	C11 = Vp0^2*(1+2*eps);
    C33 = Vp0^2;
    C44 = Vs0^2;
    C66 = Vs0^2*(1+2*gam);
    C13 = sqrt((Vp0^2-Vs0^2)*((1+2*delt)*Vp0^2-Vs0^2))-Vs0^2;
    
    a1 = a(1);
    a3 = a(3);

    % p3^12
    coefPoly_p3(1) = (a3^6*C13^2*C44-a3^6*C11*C33*C44+a3^6*C11*C44^2+2*a3^6*C13*C44^2+a3^6*C33*C44^2-a3^6*C13^2*C66+a3^6*C11*C33*C66-a3^6*C11*C44*C66-2*a3^6*C13*C44*C66-a3^6*C33*C44*C66);
    % p3^11
    coefPoly_p3(2) = 0;
    % p3^10
    coefPoly_p3(3) = (-a3^4*C13^2*C44+a3^4*C11*C33*C44-2*a3^4*C11*C44^2-2*a3^4*C13*C44^2+2*a3^4*C13^2*C66-2*a3^4*C11*C33*C66+3*a3^4*C11*C44*C66+4*a3^4*C13*C44*C66+a3^4*C33*C44*C66+...
        6*a1*a3^5*C13^2*C44*p1^2-6*a1*a3^5*C11*C33*C44*p1^2+6*a1*a3^5*C11*C44^2*p1^2+12*a1*a3^5*C13*C44^2*p1^2+6*a1*a3^5*C33*C44^2*p1^2-6*a1*a3^5*C13^2*C66*p1^2+...
        6*a1*a3^5*C11*C33*C66*p1^2-6*a1*a3^5*C11*C44*C66*p1^2-12*a1*a3^5*C13*C44*C66*p1^2-6*a1*a3^5*C33*C44*C66*p1^2);
    % p3^9
    coefPoly_p3(4) = 0;
    % p3^8
    coefPoly_p3(5) = (-a3^4*C13^2+a3^4*C11*C33-2*a3^4*C13*C44-2*a3^4*C33*C44+a3^2*C11*C44^2-a3^4*C11*C66-a3^2*C13^2*C66+a3^4*C33*C66+a3^2*C11*C33*C66-3*a3^2*C11*C44*C66-...
        2*a3^2*C13*C44*C66-4*a1*a3^3*C13^2*C44*p1^2-a3^4*C13^2*C44*p1^2+4*a1*a3^3*C11*C33*C44*p1^2+a3^4*C11*C33*C44*p1^2-8*a1*a3^3*C11*C44^2*p1^2-2*a3^4*C11*C44^2*p1^2-...
        8*a1*a3^3*C13*C44^2*p1^2-2*a3^4*C13*C44^2*p1^2+8*a1*a3^3*C13^2*C66*p1^2+2*a3^4*C13^2*C66*p1^2-8*a1*a3^3*C11*C33*C66*p1^2-2*a3^4*C11*C33*C66*p1^2+12*a1*a3^3*C11*C44*C66*p1^2+...
        3*a3^4*C11*C44*C66*p1^2+16*a1*a3^3*C13*C44*C66*p1^2+4*a3^4*C13*C44*C66*p1^2+4*a1*a3^3*C33*C44*C66*p1^2+a3^4*C33*C44*C66*p1^2+15*a1^2*a3^4*C13^2*C44*p1^4-...
        15*a1^2*a3^4*C11*C33*C44*p1^4+15*a1^2*a3^4*C11*C44^2*p1^4+30*a1^2*a3^4*C13*C44^2*p1^4+15*a1^2*a3^4*C33*C44^2*p1^4-15*a1^2*a3^4*C13^2*C66*p1^4+15*a1^2*a3^4*C11*C33*C66*p1^4-...
        15*a1^2*a3^4*C11*C44*C66*p1^4-30*a1^2*a3^4*C13*C44*C66*p1^4-15*a1^2*a3^4*C33*C44*C66*p1^4);
    % p3^7
    coefPoly_p3(6) = 0;
    % p3^6
    coefPoly_p3(7) = (a3^2*C13^2-a3^2*C11*C33+a3^2*C11*C44+2*a3^2*C13*C44-a3^2*C44^2+2*a3^2*C11*C66-a3^2*C33*C66+a3^2*C44*C66+C11*C44*C66-4*a1*a3^3*C13^2*p1^2+4*a1*a3^3*C11*C33*p1^2-...
        8*a1*a3^3*C13*C44*p1^2-8*a1*a3^3*C33*C44*p1^2+2*a1*a3*C11*C44^2*p1^2+2*a3^2*C11*C44^2*p1^2-4*a1*a3^3*C11*C66*p1^2-2*a1*a3*C13^2*C66*p1^2-2*a3^2*C13^2*C66*p1^2+...
        4*a1*a3^3*C33*C66*p1^2+2*a1*a3*C11*C33*C66*p1^2+2*a3^2*C11*C33*C66*p1^2-6*a1*a3*C11*C44*C66*p1^2-6*a3^2*C11*C44*C66*p1^2-4*a1*a3*C13*C44*C66*p1^2-4*a3^2*C13*C44*C66*p1^2-...
        6*a1^2*a3^2*C13^2*C44*p1^4-4*a1*a3^3*C13^2*C44*p1^4+6*a1^2*a3^2*C11*C33*C44*p1^4+4*a1*a3^3*C11*C33*C44*p1^4-12*a1^2*a3^2*C11*C44^2*p1^4-8*a1*a3^3*C11*C44^2*p1^4-...
        12*a1^2*a3^2*C13*C44^2*p1^4-8*a1*a3^3*C13*C44^2*p1^4+12*a1^2*a3^2*C13^2*C66*p1^4+8*a1*a3^3*C13^2*C66*p1^4-12*a1^2*a3^2*C11*C33*C66*p1^4-8*a1*a3^3*C11*C33*C66*p1^4+...
        18*a1^2*a3^2*C11*C44*C66*p1^4+12*a1*a3^3*C11*C44*C66*p1^4+24*a1^2*a3^2*C13*C44*C66*p1^4+16*a1*a3^3*C13*C44*C66*p1^4+6*a1^2*a3^2*C33*C44*C66*p1^4+4*a1*a3^3*C33*C44*C66*p1^4+...
        20*a1^3*a3^3*C13^2*C44*p1^6-20*a1^3*a3^3*C11*C33*C44*p1^6+20*a1^3*a3^3*C11*C44^2*p1^6+40*a1^3*a3^3*C13*C44^2*p1^6+20*a1^3*a3^3*C33*C44^2*p1^6-20*a1^3*a3^3*C13^2*C66*p1^6+...
        20*a1^3*a3^3*C11*C33*C66*p1^6-20*a1^3*a3^3*C11*C44*C66*p1^6-40*a1^3*a3^3*C13*C44*C66*p1^6-20*a1^3*a3^3*C33*C44*C66*p1^6);
    % p3^5
    coefPoly_p3(8) = 0;
    % p3^4
    coefPoly_p3(9) = (-a3^2*C11+a3^2*C33+a3^2*C44-C11*C44-a3^2*C66-C11*C66-C44*C66+2*a1*a3*C13^2*p1^2+a3^2*C13^2*p1^2-2*a1*a3*C11*C33*p1^2-a3^2*C11*C33*p1^2+2*a1*a3*C11*C44*p1^2+...
        a3^2*C11*C44*p1^2+4*a1*a3*C13*C44*p1^2+2*a3^2*C13*C44*p1^2-2*a1*a3*C44^2*p1^2-a3^2*C44^2*p1^2+4*a1*a3*C11*C66*p1^2+2*a3^2*C11*C66*p1^2-2*a1*a3*C33*C66*p1^2-a3^2*C33*C66*p1^2+...
        2*a1*a3*C44*C66*p1^2+a3^2*C44*C66*p1^2+3*C11*C44*C66*p1^2-6*a1^2*a3^2*C13^2*p1^4+6*a1^2*a3^2*C11*C33*p1^4-12*a1^2*a3^2*C13*C44*p1^4-12*a1^2*a3^2*C33*C44*p1^4+a1^2*C11*C44^2*p1^4+...
        4*a1*a3*C11*C44^2*p1^4+a3^2*C11*C44^2*p1^4-6*a1^2*a3^2*C11*C66*p1^4-a1^2*C13^2*C66*p1^4-4*a1*a3*C13^2*C66*p1^4-a3^2*C13^2*C66*p1^4+6*a1^2*a3^2*C33*C66*p1^4+a1^2*C11*C33*C66*p1^4+...
        4*a1*a3*C11*C33*C66*p1^4+a3^2*C11*C33*C66*p1^4-3*a1^2*C11*C44*C66*p1^4-12*a1*a3*C11*C44*C66*p1^4-3*a3^2*C11*C44*C66*p1^4-2*a1^2*C13*C44*C66*p1^4-8*a1*a3*C13*C44*C66*p1^4-...
        2*a3^2*C13*C44*C66*p1^4-4*a1^3*a3*C13^2*C44*p1^6-6*a1^2*a3^2*C13^2*C44*p1^6+4*a1^3*a3*C11*C33*C44*p1^6+6*a1^2*a3^2*C11*C33*C44*p1^6-8*a1^3*a3*C11*C44^2*p1^6-...
        12*a1^2*a3^2*C11*C44^2*p1^6-8*a1^3*a3*C13*C44^2*p1^6-12*a1^2*a3^2*C13*C44^2*p1^6+8*a1^3*a3*C13^2*C66*p1^6+12*a1^2*a3^2*C13^2*C66*p1^6-8*a1^3*a3*C11*C33*C66*p1^6-...
        12*a1^2*a3^2*C11*C33*C66*p1^6+12*a1^3*a3*C11*C44*C66*p1^6+18*a1^2*a3^2*C11*C44*C66*p1^6+16*a1^3*a3*C13*C44*C66*p1^6+24*a1^2*a3^2*C13*C44*C66*p1^6+4*a1^3*a3*C33*C44*C66*p1^6+...
        6*a1^2*a3^2*C33*C44*C66*p1^6+15*a1^4*a3^2*C13^2*C44*p1^8-15*a1^4*a3^2*C11*C33*C44*p1^8+15*a1^4*a3^2*C11*C44^2*p1^8+30*a1^4*a3^2*C13*C44^2*p1^8+15*a1^4*a3^2*C33*C44^2*p1^8-...
        15*a1^4*a3^2*C13^2*C66*p1^8+15*a1^4*a3^2*C11*C33*C66*p1^8-15*a1^4*a3^2*C11*C44*C66*p1^8-30*a1^4*a3^2*C13*C44*C66*p1^8-15*a1^4*a3^2*C33*C44*C66*p1^8);
    % p3^3
    coefPoly_p3(10) = 0;
    % p3^2
    coefPoly_p3(11) = (C11+C44+C66-2*a1*a3*C11*p1^2+2*a1*a3*C33*p1^2+2*a1*a3*C44*p1^2-2*C11*C44*p1^2-2*a1*a3*C66*p1^2-2*C11*C66*p1^2-2*C44*C66*p1^2+a1^2*C13^2*p1^4+2*a1*a3*C13^2*p1^4-...
        a1^2*C11*C33*p1^4-2*a1*a3*C11*C33*p1^4+a1^2*C11*C44*p1^4+2*a1*a3*C11*C44*p1^4+2*a1^2*C13*C44*p1^4+4*a1*a3*C13*C44*p1^4-a1^2*C44^2*p1^4-2*a1*a3*C44^2*p1^4+2*a1^2*C11*C66*p1^4+...
        4*a1*a3*C11*C66*p1^4-a1^2*C33*C66*p1^4-2*a1*a3*C33*C66*p1^4+a1^2*C44*C66*p1^4+2*a1*a3*C44*C66*p1^4+3*C11*C44*C66*p1^4-4*a1^3*a3*C13^2*p1^6+4*a1^3*a3*C11*C33*p1^6-...
        8*a1^3*a3*C13*C44*p1^6-8*a1^3*a3*C33*C44*p1^6+2*a1^2*C11*C44^2*p1^6+2*a1*a3*C11*C44^2*p1^6-4*a1^3*a3*C11*C66*p1^6-2*a1^2*C13^2*C66*p1^6-2*a1*a3*C13^2*C66*p1^6+...
        4*a1^3*a3*C33*C66*p1^6+2*a1^2*C11*C33*C66*p1^6+2*a1*a3*C11*C33*C66*p1^6-6*a1^2*C11*C44*C66*p1^6-6*a1*a3*C11*C44*C66*p1^6-4*a1^2*C13*C44*C66*p1^6-4*a1*a3*C13*C44*C66*p1^6-...
        a1^4*C13^2*C44*p1^8-4*a1^3*a3*C13^2*C44*p1^8+a1^4*C11*C33*C44*p1^8+4*a1^3*a3*C11*C33*C44*p1^8-2*a1^4*C11*C44^2*p1^8-8*a1^3*a3*C11*C44^2*p1^8-2*a1^4*C13*C44^2*p1^8-...
        8*a1^3*a3*C13*C44^2*p1^8+2*a1^4*C13^2*C66*p1^8+8*a1^3*a3*C13^2*C66*p1^8-2*a1^4*C11*C33*C66*p1^8-8*a1^3*a3*C11*C33*C66*p1^8+3*a1^4*C11*C44*C66*p1^8+12*a1^3*a3*C11*C44*C66*p1^8+...
        4*a1^4*C13*C44*C66*p1^8+16*a1^3*a3*C13*C44*C66*p1^8+a1^4*C33*C44*C66*p1^8+4*a1^3*a3*C33*C44*C66*p1^8+6*a1^5*a3*C13^2*C44*p1^10-6*a1^5*a3*C11*C33*C44*p1^10+...
        6*a1^5*a3*C11*C44^2*p1^10+12*a1^5*a3*C13*C44^2*p1^10+6*a1^5*a3*C33*C44^2*p1^10-6*a1^5*a3*C13^2*C66*p1^10+6*a1^5*a3*C11*C33*C66*p1^10-6*a1^5*a3*C11*C44*C66*p1^10-...
        12*a1^5*a3*C13*C44*C66*p1^10-6*a1^5*a3*C33*C44*C66*p1^10);
    % p3^1
    coefPoly_p3(12) = 0;
    % p3^0
    coefPoly_p3(13) = (-1+C11*p1^2+C44*p1^2+C66*p1^2-a1^2*C11*p1^4+a1^2*C33*p1^4+a1^2*C44*p1^4-C11*C44*p1^4-a1^2*C66*p1^4-C11*C66*p1^4-C44*C66*p1^4+a1^2*C13^2*p1^6-a1^2*C11*C33*p1^6+...
        a1^2*C11*C44*p1^6+2*a1^2*C13*C44*p1^6-a1^2*C44^2*p1^6+2*a1^2*C11*C66*p1^6-a1^2*C33*C66*p1^6+a1^2*C44*C66*p1^6+C11*C44*C66*p1^6-a1^4*C13^2*p1^8+a1^4*C11*C33*p1^8-...
        2*a1^4*C13*C44*p1^8-2*a1^4*C33*C44*p1^8+a1^2*C11*C44^2*p1^8-a1^4*C11*C66*p1^8-a1^2*C13^2*C66*p1^8+a1^4*C33*C66*p1^8+a1^2*C11*C33*C66*p1^8-3*a1^2*C11*C44*C66*p1^8-...
        2*a1^2*C13*C44*C66*p1^8-a1^4*C13^2*C44*p1^10+a1^4*C11*C33*C44*p1^10-2*a1^4*C11*C44^2*p1^10-2*a1^4*C13*C44^2*p1^10+2*a1^4*C13^2*C66*p1^10-2*a1^4*C11*C33*C66*p1^10+...
        3*a1^4*C11*C44*C66*p1^10+4*a1^4*C13*C44*C66*p1^10+a1^4*C33*C44*C66*p1^10+a1^6*C13^2*C44*p1^12-a1^6*C11*C33*C44*p1^12+a1^6*C11*C44^2*p1^12+2*a1^6*C13*C44^2*p1^12+...
        a1^6*C33*C44^2*p1^12-a1^6*C13^2*C66*p1^12+a1^6*C11*C33*C66*p1^12-a1^6*C11*C44*C66*p1^12-2*a1^6*C13*C44*C66*p1^12-a1^6*C33*C44*C66*p1^12);

end    % of the function

%%